<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <script th:src="@{/js/lib/axios.min.js}"></script>
    <link rel="stylesheet" th:href="@{/css/lib/bootstrap.min.css}">
    <link rel="stylesheet" th:href="@{/css/lib/all.min.css}">
    <link rel="stylesheet" th:href="@{/css/lib/css2.css}">
    <link rel="stylesheet" th:href="@{/css/common.css}">
    <link rel="stylesheet" th:href="@{/css/darkmode.css}">
    <title>Profile</title>
    <style>
        /* --- Sidebar Profile Style --- */
        .nav-section-title {
            font-weight: 600;
            color: var(--primary-color) !important;
            font-size: 1rem;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 6px;
            margin-top: 1.2rem;
        }

        .nav-link-custom {
            display: block;
            padding: 0.55rem 1rem;
            border-radius: 10px;
            color: var(--text-color);
            transition: all 0.3s ease;
            font-weight: 500;
            margin-bottom: 4px;
            text-decoration: none;
        }

        .nav-link-custom:hover {
            background-color: var(--bg-light);
            color: var(--primary-color);
        }

        .nav-link-custom.active {
            background-color: var(--secondary-color) !important;
            color: #000 !important;
            font-weight: 600 !important;
        }
    </style>
</head>
<body>
<!-- Header -->
<div th:replace="~{components-features/header::header}"></div>

<!-- Main content -->
<div class="container-fluid mt-4">
    <div class="row">
        <div th:replace="~{users-features/components/Left-navbar::leftnavbar}"></div>

        <div class="col-md-9">
            <div class="tab-content" id="profileTabContent">
                <!-- Thong bao he thong -->
                <div class="tab-pane fade" id="system">
                    <div class="notification-group mb-4">
                        <h5><i class="bi bi-gear-fill text-secondary"></i> Th√¥ng b√°o h·ªá th·ªëng</h5>
                        <div class="alert alert-info d-flex justify-content-between align-items-start">
                            <div>
                                <strong>‚öôÔ∏è B·∫£o tr√¨ h·ªá th·ªëng</strong><br>
                                H·ªá th·ªëng s·∫Ω b·∫£o tr√¨ t·ª´ 0h - 2h ng√†y 01/05/2025. Vui l√≤ng kh√¥ng thao t√°c trong th·ªùi
                                gian n√†y.
                                <div class="small text-muted mt-1">Nh·∫≠n l√∫c: 24/04/2025 20:30 | <span
                                        class="badge bg-success">ƒê√£ ƒë·ªçc</span></div>
                            </div>
                            <div class="btn-group ms-2">
                                <button class="btn btn-sm btn-outline-success" disabled>‚úì</button>
                                <button class="btn btn-sm btn-outline-danger"
                                        onclick="deleteNotification(this)">üóë
                                </button>
                            </div>
                        </div>
                        <div class="alert alert-info d-flex justify-content-between align-items-start">
                            <div>
                                <strong>‚öôÔ∏è B·∫£o tr√¨ h·ªá th·ªëng</strong><br>
                                ‚ÑπÔ∏è Ch√≠nh s√°ch ng∆∞·ªùi d√πng m·ªõi ƒë∆∞·ª£c c·∫≠p nh·∫≠t.
                                <div class="small text-muted mt-1">Nh·∫≠n l√∫c: 24/04/2025 20:30 | <span
                                        class="badge bg-success">ƒê√£ ƒë·ªçc</span></div>
                            </div>
                            <div class="btn-group ms-2">
                                <button class="btn btn-sm btn-outline-success" disabled>‚úì</button>
                                <button class="btn btn-sm btn-outline-danger"
                                        onclick="deleteNotification(this)">üóë
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Thong bao ve uu dai -->
                <div class="tab-pane fade" id="promotion">
                    <div class="notification-group mb-4">
                        <h5><i class="bi bi-gift-fill text-danger"></i> ∆Øu ƒë√£i</h5>
                        <div class="alert alert-warning d-flex justify-content-between align-items-start">
                            <div>
                                <strong>üéâ ∆Øu ƒë√£i th√°ng 5</strong><br>
                                B·∫°n nh·∫≠n ƒë∆∞·ª£c m√£ gi·∫£m 50.000‚Ç´ cho ƒë∆°n ƒë·∫ßu ti√™n!
                                <a href="#">T√¨m hi·ªÉu ngay</a>
                                <div class="small text-muted mt-1">Nh·∫≠n l√∫c: 25/04/2025 09:00 | <span
                                        class="badge bg-secondary">Ch∆∞a ƒë·ªçc</span></div>
                            </div>
                            <div class="btn-group ms-2">
                                <button class="btn btn-sm btn-outline-success" onclick="markAsRead(this)">‚úì</button>
                                <button class="btn btn-sm btn-outline-danger"
                                        onclick="deleteNotification(this)">üóë
                                </button>
                            </div>
                        </div>
                        <div class="alert alert-warning d-flex justify-content-between align-items-start">
                            <div>
                                üî• Gi·∫£m 20% cho ng∆∞·ªùi d√πng m·ªõi trong th√°ng 5.
                                <a href="#">T√¨m hi·ªÉu ngay</a>
                                <div class="small text-muted mt-1">Nh·∫≠n l√∫c: 25/04/2025 09:00 | <span
                                        class="badge bg-secondary">Ch∆∞a ƒë·ªçc</span></div>
                            </div>
                            <div class="btn-group ms-2">
                                <button class="btn btn-sm btn-outline-success" onclick="markAsRead(this)">‚úì</button>
                                <button class="btn btn-sm btn-outline-danger"
                                        onclick="deleteNotification(this)">üóë
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Thong bao tu chu tro -->
                <div class="tab-pane fade" id="owner">
                    <div class="notification-group mb-4">
                        <h5><i class="bi bi-house-heart-fill text-success"></i> T·ª´ ch·ªß tr·ªç</h5>
                        <div class="alert alert-success d-flex justify-content-between align-items-start">
                            <div>
                                <strong>üì© Tin nh·∫Øn m·ªõi t·ª´ ch·ªß tr·ªç</strong><br>
                                Ch·ªß tr·ªç "Nguy·ªÖn VƒÉn A" ƒë√£ g·ª≠i tin nh·∫Øn cho b·∫°n.
                                <a href="#">Xem ph·∫£n h·ªìi</a>
                                <div class="small text-muted mt-1">Nh·∫≠n l√∫c: 25/04/2025 11:45 | <span
                                        class="badge bg-secondary">Ch∆∞a ƒë·ªçc</span></div>
                            </div>
                            <div class="btn-group ms-2">
                                <button class="btn btn-sm btn-outline-success" onclick="markAsRead(this)">‚úì</button>
                                <button class="btn btn-sm btn-outline-danger"
                                        onclick="deleteNotification(this)">üóë
                                </button>
                            </div>
                        </div>
                        <div class="alert alert-success d-flex justify-content-between align-items-start">
                            <div>
                                <strong>üì© Tin nh·∫Øn m·ªõi t·ª´ ch·ªß tr·ªç</strong><br>
                                üè† Ch·ªß tr·ªç "Nguy·ªÖn VƒÉn A" ƒë√£ ph·∫£n h·ªìi y√™u c·∫ßu ƒë·∫∑t ph√≤ng c·ªßa b·∫°n.
                                <a href="#">Xem ph·∫£n h·ªìi</a>
                                <div class="small text-muted mt-1">Nh·∫≠n l√∫c: 25/04/2025 11:45 | <span
                                        class="badge bg-secondary">Ch∆∞a ƒë·ªçc</span></div>
                            </div>
                            <div class="btn-group ms-2">
                                <button class="btn btn-sm btn-outline-success" onclick="markAsRead(this)">‚úì</button>
                                <button class="btn btn-sm btn-outline-danger"
                                        onclick="deleteNotification(this)">üóë
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Thong tin nguoi dung -->
                <div class="tab-pane fade show active" id="info">
                    <h4>Th√¥ng tin ng∆∞·ªùi d√πng</h4>
                    <form id="userInfoForm" class="row g-4 mt-3" enctype="multipart/form-data">
                        <!-- ·∫¢nh ƒë·∫°i di·ªán -->
                        <div class="col-md-3 text-center">
                            <img id="avatarPreview" src="/images/image1.png" class="rounded-circle shadow-sm"
                                 width="120" height="120" alt="Avatar">
                            <div class="mt-2">
                                <label for="avatarInput" class="btn btn-outline-primary btn-sm">üñºÔ∏è Ch·ªçn ·∫£nh</label>
                                <input type="file" class="d-none" id="avatarInput" accept="image/*">
                            </div>
                        </div>

                        <!-- Th√¥ng tin -->
                        <div class="col-md-9">
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label class="form-label">H·ªç t√™n</label>
                                    <input type="text" class="form-control" id="fullName" value="Tr·∫ßn Xu√¢n Ho√†n"
                                           readonly>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label" id="emailField">Email</label>
                                    <input type="email" class="form-control" id="email" value="hoan@example.com"
                                           readonly>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">S·ªë ƒëi·ªán tho·∫°i</label>
                                    <input type="text" class="form-control" id="phone" value="0989999999" readonly>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Ng√†y sinh</label>
                                    <input type="date" class="form-control" id="dob" value="1995-01-01" readonly>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Gi·ªõi t√≠nh</label>
                                    <select class="form-select" id="gender" disabled>
                                        <option selected>Nam</option>
                                        <option>N·ªØ</option>
                                        <option>Kh√°c</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">T·ªânh/Th√†nh ph·ªë</label>
                                    <input type="text" class="form-control" id="province" value="TP.HCM" readonly>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Qu·∫≠n/Huy·ªán</label>
                                    <input type="text" class="form-control" id="district" value="Qu·∫≠n 1" readonly>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">S·ªë nh√†</label>
                                    <input type="text" class="form-control" id="houseNumber" value="123" readonly>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">T√™n ƒë∆∞·ªùng</label>
                                    <input type="text" class="form-control" id="street" value="ƒê∆∞·ªùng ABC" readonly>
                                </div>
                            </div>

                            <div class="mt-4 d-flex gap-3">
                                <button type="button" id="editInfoBtn" class="btn btn-primary">‚úèÔ∏è Ch·ªânh s·ª≠a</button>
                                <button type="submit" id="saveInfoBtn" class="btn btn-success d-none">üíæ L∆∞u thay
                                    ƒë·ªïi
                                </button>
                            </div>
                        </div>
                    </form>
                </div>

                <!-- Doi mat khau -->
                <div class="tab-pane fade" id="password">
                    <h4 class="mb-4">üîê ƒê·ªïi m·∫≠t kh·∫©u</h4>
                    <form id="changePasswordForm"
                          class="p-4 border rounded shadow-sm bg-white dark-mode-support needs-validation" novalidate>
                        <div class="mb-3 position-relative">
                            <label for="currentPassword" class="form-label fw-bold">M·∫≠t kh·∫©u hi·ªán t·∫°i</label>
                            <div class="input-group">
                                <input type="password" class="form-control" id="currentPassword"
                                       placeholder="Nh·∫≠p m·∫≠t kh·∫©u hi·ªán t·∫°i" required>
                                <button class="btn btn-outline-secondary toggle-password" type="button"
                                        data-target="currentPassword" hidden>
                                    <i class="bi bi-eye"></i>
                                </button>
                            </div>
                            <div class="invalid-feedback">Vui l√≤ng nh·∫≠p m·∫≠t kh·∫©u hi·ªán t·∫°i.</div>
                        </div>

                        <div class="mb-3 position-relative">
                            <label for="newPassword" class="form-label fw-bold">M·∫≠t kh·∫©u m·ªõi</label>
                            <div class="input-group">
                                <input type="password" class="form-control" id="newPassword"
                                       placeholder="T·∫°o m·∫≠t kh·∫©u m·ªõi" required>
                                <button class="btn btn-outline-secondary toggle-password" type="button"
                                        data-target="newPassword" hidden>
                                    <i class="bi bi-eye"></i>
                                </button>
                            </div>
                            <div class="form-text">
                                M·∫≠t kh·∫©u ph·∫£i c√≥ √≠t nh·∫•t 8 k√Ω t·ª±, bao g·ªìm ch·ªØ hoa, ch·ªØ th∆∞·ªùng, s·ªë v√† k√Ω t·ª± ƒë·∫∑c bi·ªát.
                            </div>
                            <div class="invalid-feedback" id="newPasswordFeedback"></div>
                        </div>

                        <div class="mb-3 position-relative">
                            <label for="confirmPassword" class="form-label fw-bold">Nh·∫≠p l·∫°i m·∫≠t kh·∫©u m·ªõi</label>
                            <div class="input-group">
                                <input type="password" class="form-control" id="confirmPassword"
                                       placeholder="Nh·∫≠p l·∫°i m·∫≠t kh·∫©u m·ªõi" required>
                                <button class="btn btn-outline-secondary toggle-password" type="button"
                                        data-target="confirmPassword" hidden>
                                    <i class="bi bi-eye"></i>
                                </button>
                            </div>
                            <div class="invalid-feedback" id="confirmPasswordFeedback"></div>
                        </div>
                        <button type="submit" class="btn btn-primary">ƒê·ªïi m·∫≠t kh·∫©u</button>
                        <div id="passwordMessage" class="mt-3 text-center"></div>
                    </form>
                </div>

                <!-- Cai dat thong bao -->
                <div class="tab-pane fade" id="notification-setting">
                    <div class="notification-settings p-4 bg-white dark-mode-support rounded shadow-sm">
                        <h4 class="mb-4"><i class="bi bi-bell-fill me-2"></i>C√†i ƒë·∫∑t th√¥ng b√°o</h4>

                        <!-- ∆Øu ƒë√£i -->
                        <div class="mb-3">
                            <label class="form-label fw-bold">Th√¥ng b√°o ∆∞u ƒë√£i</label>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="promoNotify" checked>
                                <label class="form-check-label" for="promoNotify">Nh·∫≠n th√¥ng b√°o ∆∞u ƒë√£i m·ªõi</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="promoType" id="promoWeb" checked>
                                <label class="form-check-label" for="promoWeb">Hi·ªÉn th·ªã tr√™n web</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="promoType" id="promoEmail">
                                <label class="form-check-label" for="promoEmail">G·ª≠i qua email</label>
                            </div>
                        </div>

                        <!-- H·ªá th·ªëng -->
                        <div class="mb-3 border-top pt-3">
                            <label class="form-label fw-bold">Th√¥ng b√°o h·ªá th·ªëng</label>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="systemNotify" checked>
                                <label class="form-check-label" for="systemNotify">Nh·∫≠n th√¥ng b√°o b·∫£o tr√¨, ch√≠nh
                                    s√°ch, v.v.</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="systemType" id="systemWeb"
                                       checked>
                                <label class="form-check-label" for="systemWeb">Hi·ªÉn th·ªã tr√™n web</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="systemType" id="systemEmail">
                                <label class="form-check-label" for="systemEmail">G·ª≠i qua email</label>
                            </div>
                        </div>

                        <!-- T·ª´ ch·ªß tr·ªç -->
                        <div class="mb-3 border-top pt-3">
                            <label class="form-label fw-bold">Th√¥ng b√°o t·ª´ ch·ªß tr·ªç</label>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="ownerNotify" checked>
                                <label class="form-check-label" for="ownerNotify">
                                    Nh·∫≠n th√¥ng b√°o tin nh·∫Øn, ph·∫£n h·ªìi t·ª´ ch·ªß tr·ªç
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="ownerType" id="ownerWeb" checked>
                                <label class="form-check-label" for="ownerWeb">Hi·ªÉn th·ªã tr√™n web</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="ownerType" id="ownerEmail">
                                <label class="form-check-label" for="ownerEmail">G·ª≠i qua email</label>
                            </div>
                        </div>

                        <!-- N√∫t l∆∞u -->
                        <div class="text-end mt-4">
                            <button class="btn btn-primary" onclick="saveNotificationSettings()">
                                L∆∞u thay ƒë·ªïi
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Bai dang -->
                <div class="tab-pane fade" id="myposts">
                    <h4>B√†i ƒëƒÉng c·ªßa t√¥i</h4>
                    <div id="userPosts"></div>
                </div>

                <!-- Lich su tuong tac -->
                <div class="tab-pane fade" id="history">
                    <div class="tab-pane fade show active" id="interactionHistory">
                        <h4 class="mb-3">üìú L·ªãch s·ª≠ t∆∞∆°ng t√°c</h4>

                        <!-- B·ªô l·ªçc -->
                        <div class="mb-3">
                            <label for="filterType" class="form-label">L·ªçc theo h√†nh ƒë·ªông:</label>
                            <select class="form-select w-auto" id="filterType" onchange="renderInteractions()">
                                <option value="all">T·∫•t c·∫£</option>
                                <option value="viewed">ƒê√£ xem</option>
                                <option value="saved">ƒê√£ l∆∞u</option>
                                <option value="contacted">ƒê√£ li√™n h·ªá</option>
                            </select>
                        </div>

                        <!-- B·∫£ng l·ªãch s·ª≠ -->
                        <div class="table-responsive">
                            <table class="table table-bordered align-middle">
                                <thead class="table-light">
                                <tr>
                                    <th>Ti√™u ƒë·ªÅ b√†i tr·ªç</th>
                                    <th>H√†nh ƒë·ªông</th>
                                    <th>Th·ªùi gian</th>
                                    <th></th>
                                </tr>
                                </thead>
                                <tbody id="interactionTableBody">
                                <!-- D·ªØ li·ªáu s·∫Ω ƒë∆∞·ª£c ch√®n b·∫±ng JavaScript -->
                                </tbody>
                            </table>
                        </div>

                        <!-- X√≥a to√†n b·ªô -->
                        <button class="btn btn-danger mt-2" onclick="clearInteractionHistory()">
                            üóëÔ∏è X√≥a to√†n b·ªô l·ªãch s·ª≠
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script th:src="@{/js/lib/bootstrap.bundle.min.js}"></script>
<script th:src="@{/js/lib/jquery-3.7.1.min.js}"></script>
<script th:src="@{/js/common.js}" type="module"></script>
<script th:src="@{/js/cart/GetCart.js}" type="module"></script>
<script type="text/javascript" src="https://cdn.fchat.vn/assets/embed/webchat.js?id=68046fcf7eb26f456e0a70a5"
        async="async"></script>
<script th:src="@{/js/lib/sockjs.min.js}"></script>
<script th:src="@{/js/lib/stomp.min.js}"></script>
<script th:src="@{/js/profile/EditUserProfile.js}"></script>
<script th:src="@{/js/profile/InteractionHistory.js}"></script>
<script th:src="@{/js/profile/SolveNotificationSetting.js}"></script>
</body>
</html>