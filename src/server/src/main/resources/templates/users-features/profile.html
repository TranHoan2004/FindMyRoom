<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <script th:src="@{/js/lib/axios.min.js}"></script>
    <link rel="stylesheet" th:href="@{/css/lib/bootstrap.min.css}">
    <link rel="stylesheet" th:href="@{/css/lib/all.min.css}">
    <link rel="stylesheet" th:href="@{/css/lib/css2.css}">
    <link rel="stylesheet" th:href="@{/css/components/common.css}">
    <link rel="stylesheet" th:href="@{/css/components/darkmode.css}">
    <link rel="stylesheet" th:href="@{/css/components/profile.css}">
    <title th:text="${profile_title}"></title>
</head>
<body>
<!-- Header -->
<div th:replace="~{components-features/header::header}"></div>

<!-- Main content -->
<div class="container-fluid mt-4">
    <div class="row">
        <div th:replace="~{users-features/components/Left-navbar::leftnavbar}"></div>

        <div class="col-md-9">
            <div class="tab-content" id="profileTabContent">
                <!-- Thong bao he thong -->
                <div class="tab-pane fade" id="system">
                    <div class="notification-group mb-4">
                        <h5>
                            <i class="bi bi-gear-fill text-secondary"></i>
                            <span th:text="${system_noti}"></span>
                        </h5>
                        <div class="alert alert-info d-flex justify-content-between align-items-start">
                            <div>
                                <strong>‚öôÔ∏è B·∫£o tr√¨ h·ªá th·ªëng</strong><br>
                                H·ªá th·ªëng s·∫Ω b·∫£o tr√¨ t·ª´ 0h - 2h ng√†y 01/05/2025. Vui l√≤ng kh√¥ng thao t√°c trong th·ªùi
                                gian n√†y.
                                <div class="small text-muted mt-1">Nh·∫≠n l√∫c: 24/04/2025 20:30 | <span
                                        class="badge bg-success">ƒê√£ ƒë·ªçc</span></div>
                            </div>
                            <div class="btn-group ms-2">
                                <button class="btn btn-sm btn-outline-success" disabled>‚úì</button>
                                <button class="btn btn-sm btn-outline-danger"
                                        onclick="deleteNotification(this)">üóë
                                </button>
                            </div>
                        </div>
                        <div class="alert alert-info d-flex justify-content-between align-items-start">
                            <div>
                                <strong>‚öôÔ∏è B·∫£o tr√¨ h·ªá th·ªëng</strong><br>
                                ‚ÑπÔ∏è Ch√≠nh s√°ch ng∆∞·ªùi d√πng m·ªõi ƒë∆∞·ª£c c·∫≠p nh·∫≠t.
                                <div class="small text-muted mt-1">Nh·∫≠n l√∫c: 24/04/2025 20:30 | <span
                                        class="badge bg-success">ƒê√£ ƒë·ªçc</span></div>
                            </div>
                            <div class="btn-group ms-2">
                                <button class="btn btn-sm btn-outline-success" disabled>‚úì</button>
                                <button class="btn btn-sm btn-outline-danger"
                                        onclick="deleteNotification(this)">üóë
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Thong bao ve uu dai -->
                <div class="tab-pane fade" id="promotion">
                    <div class="notification-group mb-4">
                        <h5>
                            <i class="bi bi-gift-fill text-danger"></i>
                            <span th:text="${sale_title}"></span>
                        </h5>
                        <div class="alert alert-warning d-flex justify-content-between align-items-start">
                            <div>
                                <strong>üéâ ∆Øu ƒë√£i th√°ng 5</strong><br>
                                B·∫°n nh·∫≠n ƒë∆∞·ª£c m√£ gi·∫£m 50.000‚Ç´ cho ƒë∆°n ƒë·∫ßu ti√™n!
                                <a href="#">T√¨m hi·ªÉu ngay</a>
                                <div class="small text-muted mt-1">Nh·∫≠n l√∫c: 25/04/2025 09:00 | <span
                                        class="badge bg-secondary" th:text="${unread_title}"></span></div>
                            </div>
                            <div class="btn-group ms-2">
                                <button class="btn btn-sm btn-outline-success" onclick="markAsRead(this)">‚úì</button>
                                <button class="btn btn-sm btn-outline-danger"
                                        onclick="deleteNotification(this)">üóë
                                </button>
                            </div>
                        </div>
                        <div class="alert alert-warning d-flex justify-content-between align-items-start">
                            <div>
                                üî• Gi·∫£m 20% cho ng∆∞·ªùi d√πng m·ªõi trong th√°ng 5.
                                <a href="#">T√¨m hi·ªÉu ngay</a>
                                <div class="small text-muted mt-1">Nh·∫≠n l√∫c: 25/04/2025 09:00 | <span
                                        class="badge bg-secondary" th:text="${unread_title}"></span></div>
                            </div>
                            <div class="btn-group ms-2">
                                <button class="btn btn-sm btn-outline-success" onclick="markAsRead(this)">‚úì</button>
                                <button class="btn btn-sm btn-outline-danger"
                                        onclick="deleteNotification(this)">üóë
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Thong bao tu chu tro -->
                <div class="tab-pane fade" id="owner">
                    <div class="notification-group mb-4">
                        <h5>
                            <i class="bi bi-house-heart-fill text-success"></i>
                            <span th:text="${from_houseowner}"></span>
                        </h5>
                        <div class="alert alert-success d-flex justify-content-between align-items-start">
                            <div>
                                <strong th:text="'üì© ' + ${new_message_from_houseowner}"></strong><br>
                                Ch·ªß tr·ªç "Nguy·ªÖn VƒÉn A" ƒë√£ g·ª≠i tin nh·∫Øn cho b·∫°n.
                                <a href="#" th:text="${see_response}"></a>
                                <div class="small text-muted mt-1">Nh·∫≠n l√∫c: 25/04/2025 11:45 | <span
                                        class="badge bg-secondary" th:text="${unread_title}"></span></div>
                            </div>
                            <div class="btn-group ms-2">
                                <button class="btn btn-sm btn-outline-success" onclick="markAsRead(this)">‚úì</button>
                                <button class="btn btn-sm btn-outline-danger"
                                        onclick="deleteNotification(this)">üóë
                                </button>
                            </div>
                        </div>
                        <div class="alert alert-success d-flex justify-content-between align-items-start">
                            <div>
                                <strong th:text="'üì© ' + ${new_message_from_houseowner}"></strong><br>
                                üè† Ch·ªß tr·ªç "Nguy·ªÖn VƒÉn A" ƒë√£ ph·∫£n h·ªìi y√™u c·∫ßu ƒë·∫∑t ph√≤ng c·ªßa b·∫°n.
                                <a href="#" th:text="${see_response}"></a>
                                <div class="small text-muted mt-1">Nh·∫≠n l√∫c: 25/04/2025 11:45 | <span
                                        class="badge bg-secondary" th:text="${unread_title}"></span></div>
                            </div>
                            <div class="btn-group ms-2">
                                <button class="btn btn-sm btn-outline-success" onclick="markAsRead(this)">‚úì</button>
                                <button class="btn btn-sm btn-outline-danger"
                                        onclick="deleteNotification(this)">üóë
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Thong tin nguoi dung -->
                <div class="tab-pane fade show active" id="info">
                    <h4 th:text="${user_information}"></h4>
                    <form id="userInfoForm" class="row g-4 mt-3" enctype="multipart/form-data">
                        <!-- ·∫¢nh ƒë·∫°i di·ªán -->
                        <div class="col-md-3 text-center">
                            <img id="avatarPreview" src="/images/image1.png" class="rounded-circle shadow-sm"
                                 width="120" height="120" alt="Avatar">
                            <div class="mt-2">
                                <label for="avatarInput" class="btn btn-outline-primary btn-sm"
                                       th:text="'üñºÔ∏è ' + ${image_select}"></label>
                                <input type="file" class="d-none" id="avatarInput" accept="image/*">
                            </div>
                        </div>

                        <!-- Th√¥ng tin -->
                        <div class="col-md-9">
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label class="form-label" th:text="${fullname_title}"></label>
                                    <input type="text" class="form-control" id="fullName" value="Tr·∫ßn Xu√¢n Ho√†n"
                                           readonly>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label" id="emailField" th:text="${email_title}"></label>
                                    <input type="email" class="form-control" id="email" value="hoan@example.com"
                                           readonly>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label" th:text="${phone_number}"></label>
                                    <input type="text" class="form-control" id="phone" value="0989999999" readonly>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label" th:text="${dob}"></label>
                                    <input type="date" class="form-control" id="dob" value="1995-01-01" readonly>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label" th:text="${gender_title}"></label>
                                    <select class="form-select" id="gender" disabled>
                                        <option selected th:text="${male_title}"></option>
                                        <option th:text="${female_title}"></option>
                                        <option th:text="${other_gender}"></option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label" th:text="${province_city}"></label>
                                    <input type="text" class="form-control" id="province" value="TP.HCM" readonly>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label" th:text="${district}"></label>
                                    <input type="text" class="form-control" id="district" value="Qu·∫≠n 1" readonly>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label" th:text="${house_number}"></label>
                                    <input type="text" class="form-control" id="houseNumber" value="123" readonly>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label" th:text="${street_name}"></label>
                                    <input type="text" class="form-control" id="street" value="ƒê∆∞·ªùng ABC" readonly>
                                </div>
                            </div>

                            <div class="mt-4 d-flex gap-3">
                                <button type="button" id="editInfoBtn" class="btn btn-primary"
                                        th:text="'‚úèÔ∏è ' + ${edit_btn}"></button>
                                <button type="submit" id="saveInfoBtn" class="btn btn-success d-none"
                                        th:text="'üíæ ' + ${save_btn}"></button>
                            </div>
                        </div>
                    </form>
                </div>

                <!-- Doi mat khau -->
                <div class="tab-pane fade" id="password">
                    <h4 class="mb-4" th:text="'üîê ' + ${reset_password}"></h4>
                    <form id="changePasswordForm"
                          class="p-4 border rounded shadow-sm bg-white dark-mode-support needs-validation" novalidate>
                        <div class="mb-3 position-relative">
                            <label for="currentPassword" class="form-label fw-bold"
                                   th:text="${current_password}"></label>
                            <div class="input-group">
                                <input type="password" class="form-control" id="currentPassword"
                                       th:placeholder="${enter_current_password}" required>
                                <button class="btn btn-outline-secondary toggle-password" type="button"
                                        data-target="currentPassword" hidden>
                                    <i class="bi bi-eye"></i>
                                </button>
                            </div>
                            <div class="invalid-feedback" th:text="${please_enter_current_password}"></div>
                        </div>

                        <div class="mb-3 position-relative">
                            <label for="newPassword" class="form-label fw-bold" th:text="${new_password}"></label>
                            <div class="input-group">
                                <input type="password" class="form-control" id="newPassword"
                                       th:placeholder="${enter_new_password}" required>
                                <button class="btn btn-outline-secondary toggle-password" type="button"
                                        data-target="newPassword" hidden>
                                    <i class="bi bi-eye"></i>
                                </button>
                            </div>
                            <div class="form-text" th:text="${new_password_condition}"></div>
                            <div class="invalid-feedback" id="newPasswordFeedback"></div>
                        </div>

                        <div class="mb-3 position-relative">
                            <label for="confirmPassword" class="form-label fw-bold"
                                   th:text="${enter_new_password_again}"></label>
                            <div class="input-group">
                                <input type="password" class="form-control" id="confirmPassword"
                                       th:placeholder="${enter_new_password_again}" required>
                                <button class="btn btn-outline-secondary toggle-password" type="button"
                                        data-target="confirmPassword" hidden>
                                    <i class="bi bi-eye"></i>
                                </button>
                            </div>
                            <div class="invalid-feedback" id="confirmPasswordFeedback"></div>
                        </div>
                        <button type="submit" class="btn btn-primary" th:text="${reset_password}"></button>
                        <div id="passwordMessage" class="mt-3 text-center"></div>
                    </form>
                </div>

                <!-- Cai dat thong bao -->
                <div class="tab-pane fade" id="notification-setting">
                    <div class="notification-settings p-4 bg-white dark-mode-support rounded shadow-sm">
                        <h4 class="mb-4">
                            <i class="bi bi-bell-fill me-2"></i>
                            <span th:text="${notification_setting}"></span>
                        </h4>

                        <!-- ∆Øu ƒë√£i -->
                        <div class="mb-3">
                            <label class="form-label fw-bold" th:text="${sale_noti}"></label>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="promoNotify" checked>
                                <label class="form-check-label" for="promoNotify"
                                       th:text="${receive_new_sale_noti}"></label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="promoType" id="promoWeb" checked>
                                <label class="form-check-label" for="promoWeb" th:text="${display_on_web}"></label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="promoType" id="promoEmail">
                                <label class="form-check-label" for="promoEmail" th:text="${send_by_email}"></label>
                            </div>
                        </div>

                        <!-- H·ªá th·ªëng -->
                        <div class="mb-3 border-top pt-3">
                            <label class="form-label fw-bold" th:text="${system_noti}"></label>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="systemNotify" checked>
                                <label class="form-check-label" for="systemNotify"
                                       th:text="${receive_all_noti}"></label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="systemType" id="systemWeb"
                                       checked>
                                <label class="form-check-label" for="systemWeb" th:text="${display_on_web}"></label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="systemType" id="systemEmail">
                                <label class="form-check-label" for="systemEmail" th:text="${send_by_email}"></label>
                            </div>
                        </div>

                        <!-- T·ª´ ch·ªß tr·ªç -->
                        <div class="mb-3 border-top pt-3">
                            <label class="form-label fw-bold" th:text="${noti_houseowner}"></label>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="ownerNotify" checked>
                                <label class="form-check-label" for="ownerNotify"
                                       th:text="${receive_noti_houseowner}"></label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="ownerType" id="ownerWeb" checked>
                                <label class="form-check-label" for="ownerWeb" th:text="${display_on_web}"></label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="ownerType" id="ownerEmail">
                                <label class="form-check-label" for="ownerEmail" th:text="${send_by_email}"></label>
                            </div>
                        </div>

                        <!-- N√∫t l∆∞u -->
                        <div class="text-end mt-4">
                            <button class="btn btn-primary" onclick="saveNotificationSettings()"
                                    th:text="${save_btn}"></button>
                        </div>
                    </div>
                </div>

                <!-- Bai dang -->
                <div class="tab-pane fade" id="myposts">
                    <h4 th:text="${my_post}"></h4>
                    <div id="userPosts"></div>
                </div>

                <!-- Lich su tuong tac -->
                <div class="tab-pane fade" id="history">
                    <div class="tab-pane fade show active" id="interactionHistory">
                        <h4 class="mb-3" th:text="'üìú ' + ${contact_history}"></h4>

                        <!-- B·ªô l·ªçc -->
                        <div class="mb-3">
                            <label for="filterType" class="form-label" th:text="${filter_by_action} + ':'"></label>
                            <select class="form-select w-auto" id="filterType" onchange="renderInteractions()">
                                <option value="all" th:text="${all_title}"></option>
                                <option value="viewed" th:text="${seen_title}"></option>
                                <option value="saved" th:text="${saved_title}"></option>
                                <option value="contacted" th:text="${contacted}"></option>
                            </select>
                        </div>

                        <!-- B·∫£ng l·ªãch s·ª≠ -->
                        <div class="table-responsive">
                            <table class="table table-bordered align-middle">
                                <thead class="table-light">
                                <tr>
                                    <th th:text="${post_title}"></th>
                                    <th th:text="${action_title}"></th>
                                    <th th:text="${time_title}"></th>
                                    <th></th>
                                </tr>
                                </thead>
                                <tbody id="interactionTableBody">
                                <!-- D·ªØ li·ªáu s·∫Ω ƒë∆∞·ª£c ch√®n b·∫±ng JavaScript -->
                                </tbody>
                            </table>
                        </div>

                        <!-- X√≥a to√†n b·ªô -->
                        <button class="btn btn-danger mt-2" onclick="clearInteractionHistory()"
                                th:text="'üóëÔ∏è ' + ${clear_history}"></button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Footer -->
<div th:replace="~{components-features/footer::footer}"></div>

<script th:inline="javascript">
    const seen = /*[[${seen_title}]]*/ {}
    const message = /*[[${save_noti_setting}]]*/ {}
    const contacted = /*[[${contacted}]]*/ {}
    const saved = /*[[${saved_title}]]*/ {}
    const alertBeforeDelete = /*[[${alert_before_delete_history}]]*/ {}
    const readOnly = /*[[${read_only}]]*/ {}
    const alert18Older = /*[[${alert_18_older}]]*/ {}
    const alertPhonenumber = /*[[${alert_phone_number}]]*/ {}
    const alertAddress = /*[[${alert_address}]]*/ {}
    const errorTitle = /*[[${error_title}]]*/ {}
    const updateSuccessfully = /*[[${update_successfully}]]*/ {}
    const passwordNotAccepted1 = /*[[${password_not_accepted1}]]*/ {}
    const passwordNotAccepted2 = /*[[${password_not_accepted2}]]*/ {}
    const passwordAccepted = /*[[${password_accepted}]]*/ {}
    const updatePasswordSuccessfully = /*[[${update_password_successfully}]]*/ {}
</script>
<script th:src="@{/js/lib/bootstrap.bundle.min.js}"></script>
<script th:src="@{/js/lib/jquery-3.7.1.min.js}"></script>
<script th:src="@{/js/common.js}" type="module"></script>
<script th:src="@{/js/cart/GetCart.js}" type="module"></script>
<script th:src="@{/js/lib/sockjs.min.js}"></script>
<script th:src="@{/js/lib/stomp.min.js}"></script>
<script th:src="@{/js/profile/EditUserProfile.js}"></script>
<script th:src="@{/js/profile/InteractionHistory.js}"></script>
<script th:src="@{/js/profile/SolveNotificationSetting.js}"></script>
<script type="text/javascript" src="https://cdn.fchat.vn/assets/embed/webchat.js?id=68046fcf7eb26f456e0a70a5"
        async="async"></script>
</body>
</html>